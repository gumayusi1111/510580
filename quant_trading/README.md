# ETF量化因子分析系统 v3.0

> 专注于A股ETF的因子有效性评估和择时策略开发

## 📋 项目概述

本项目是一个模块化的ETF量化分析系统，当前已完成**第一阶段：因子分析与筛选**。

### ✅ 已完成功能
- **因子有效性评估**: IC分析、适应性前瞻期、稳定性检验
- **评分系统v3.0**: IC(40%) + 稳定性(25%) + 分布(20%) + 质量(10%) + 一致性(5%)
- **因子去重**: 启发式去重，识别7类冗余组，减少35%冗余
- **相关性分析**: 因子冗余检测和筛选建议
- **多策略支持**: 短线/超短线/中线/多时间框架

### 🚧 开发中
- **信号生成系统**: 多因子择时策略（下一阶段）
- **回测框架**: 策略验证和参数优化
- **实盘接口**: 规划中

## 🏗️ 项目结构

```
quant_trading/
├── analyzers/              # 核心分析器
│   ├── ic/                # IC分析（适应性+传统）
│   ├── correlation/       # 相关性分析
│   ├── factor_evaluation/ # 因子评估（5维度）
│   └── redundancy_analyzer.py  # 因子去重分析
├── core/                   # 数据核心
│   ├── data_management/   # 数据管理+缓存
│   ├── loading/           # 数据加载器
│   ├── processing/        # 数据处理+清洗
│   └── validation/        # 数据验证
├── utils/                  # 工具模块
│   ├── statistics/        # 统计工具
│   │   └── scoring/      # 评分系统v3.0
│   └── reporting/         # 报告生成
├── strategies/            # 策略模块（待开发）
│   └── signal_generation/ # 信号生成
├── config/                # 配置管理
│   └── window_config.py  # 窗口参数配置
├── reports/               # 输出目录
│   └── <etf_code>/       # 各ETF报告
└── docs/                  # 项目文档
    ├── README.md         # 文档导航
    ├── design/           # 设计文档
    └── guides/           # 使用指南
```

详细结构: [PROJECT_STRUCTURE.md](docs/PROJECT_STRUCTURE.md)

## 🚀 快速开始

### 1. 安装依赖
```bash
pip install pandas numpy scipy tushare
```

### 2. 运行因子分析
```bash
# 标准模式（80因子完整分析）
python run_analysis.py short_term 510300

# 推荐模式（带去重，实盘使用）
python run_analysis.py short_term 510300 --deduplicate
```

### 3. 查看结果
```
reports/510300/
├── factor_evaluation_510300_*.md   # 详细报告
├── factor_ranking_510300_*.csv     # 因子排序
└── (去重分析输出)
```

## 📊 核心功能

### 因子评估系统（v3.0）

**评分体系**（5维度）:
- **IC表现** (40%): 信息系数，预测能力
- **稳定性** (25%): 滚动IC稳定性，时间一致性
- **分布合理性** (20%): 正态性检验，统计有效性
- **数据质量** (10%): 缺失率、异常值
- **一致性** (5%): 跨周期一致性

**v3权重优化** (2025-09-30):
- IC权重: 50% → 40% (避免高IC低稳定因子虚高)
- 稳定性权重: 20% → 25% (重视因子可靠性)
- 分布权重: 15% → 20% (重视统计健康性)

### 评级标准

| 评级 | 总分阈值 | IC阈值 | 建议用途 |
|-----|---------|--------|---------|
| A级 | ≥0.80 | ≥8% | 核心因子，优先使用 |
| B级 | 0.65-0.80 | 5-8% | 良好因子，推荐组合 |
| C级 | 0.45-0.65 | 3-5% | 备选因子，补充使用 |
| D级 | 0.30-0.45 | 2-3% | 较弱因子，观察改进 |
| F级 | <0.30 | <2% | 淘汰因子 |

### 因子去重功能 (v3.0新增)

**功能**: 识别冗余因子组，基于total_score选择最佳因子

**识别的冗余组**:
- RSI系列 (RSI_3/4/5/6/7/8)
- STOCH系列 (STOCH_K/D)
- KDJ系列 (KDJ_K/D/J)
- 移动均线系列 (SMA/EMA/WMA)
- MACD系列 (MACD_DIF/DEA/HIST)
- 波动率系列 (HV/ANNUAL_VOL)
- 布林带系列 (BOLL_UPPER/MID/LOWER)

**效果**: 80因子 → 52因子 (35%冗余去除)

**使用**:
```bash
# 集成到主流程
python run_analysis.py short_term 510300 --deduplicate

# 单独运行
python analyzers/redundancy_analyzer.py 510300
```

## 🔬 v3.0更新 (2025-09-30)

### 1. 评分权重优化 ✅
- v2 → v3权重调整
- 验证效果: WR_14排名提升(#4→#2), DAILY_RETURN合理降级

### 2. 因子去重系统 ✅
- 新增`redundancy_analyzer.py`
- 集成`--deduplicate`参数
- 35%冗余识别

### 3. 系统细节修复 ✅
- 修复Numpy警告 (23k → 0)
- 修复报告时间显示 (索引 → 日期字符串)
- NAV因子分析 (IC=0为正常现象)

### 4. 文档完善 ✅
- 更新README和文档
- v3.0使用指南
- 优化建议文档

## 📝 开发路线 (4阶段架构)

### ✅ 第一阶段: 因子分析与筛选 (已完成 v3.0)
**目标**: 建立科学的因子评估体系，筛选出有效因子

**完成内容**:
- [x] IC值分析（信息系数）- 智能适应性前瞻期
- [x] 因子衰减测试（滚动IC稳定性）- 多窗口分析
- [x] 因子相关性分析 - 冗余检测
- [x] 去除高相关因子 - 启发式去重（35%冗余）
- [x] 构建因子评分体系 - v3.0五维评分系统
  - IC表现（40%）+ 稳定性（25%）+ 分布（20%）+ 质量（10%）+ 一致性（5%）
- [x] 因子等级评定 - A/B/C/D/F五级评级
- [x] 因子报告生成 - Markdown详细报告+CSV排序表

**验证结果**:
- 510300: A级4个，WR_14 #2
- 513180: A级17个，WR_14 #8
- 510580: A级4个，WR_14 #1

### 🚧 第二阶段: 信号生成系统 (下一步 v4.0)
**目标**: 基于优质因子构建多因子择时策略

**计划内容**:
- [ ] 择时信号设计 - 定义买入/卖出信号规则
- [ ] 多因子综合评分 - 加权组合策略
- [ ] 动态阈值设定 - 自适应信号触发条件
- [ ] 买入/卖出/持有规则 - 完整交易逻辑
- [ ] 风控机制 - 止损止盈、仓位管理
- [ ] 信号回溯测试 - 历史信号准确率验证

**技术要点**:
- 使用A/B级因子构建核心策略
- 考虑因子权重动态调整
- 设计多级风控机制

### 📋 第三阶段: 回测与优化 (计划中 v5.0)
**目标**: 验证策略有效性并优化参数

**计划内容**:
- [ ] 历史回测框架 - 完整回测引擎
- [ ] 策略收益率测试 - 年化收益、夏普比率
- [ ] 风险指标计算 - 最大回撤、波动率、风险价值
- [ ] 参数敏感性分析 - 因子权重、阈值敏感性
- [ ] 参数调优 - 网格搜索/贝叶斯优化
- [ ] 样本外验证 - 防止过拟合

**评估指标**:
- 收益指标: 年化收益率、累计收益率
- 风险指标: 最大回撤、波动率、VaR
- 风险调整收益: 夏普比率、索提诺比率、卡玛比率
- 交易成本: 换手率、交易频率

### 📋 第四阶段: 实盘模拟 (计划中 v6.0)
**目标**: 模拟实盘环境验证策略可行性

**计划内容**:
- [ ] 实盘模拟系统 - 模拟真实交易环境
- [ ] 实时信号生成 - 基于最新数据生成信号
- [ ] 交易执行模拟 - 订单管理、成交模拟
- [ ] 业绩跟踪分析 - 实时监控策略表现
- [ ] 风险预警系统 - 异常情况告警
- [ ] 策略调整机制 - 动态优化策略参数

**技术要点**:
- 实时数据接入（Tushare API）
- 模拟订单撮合引擎
- 滑点和交易成本模拟
- 完整的业绩归因分析

**当前进度**: 第一阶段完成（v3.0）→ 准备进入第二阶段（v4.0）

## 📚 文档

- [文档导航](docs/README.md) - 完整文档索引
- [项目结构](docs/PROJECT_STRUCTURE.md) - 代码组织说明
- [快速开始](docs/guides/QUICK_START.md) - 5分钟上手
- [IC系统规范](docs/ic_system_technical_specification.md) - IC计算技术文档
- [优化建议](docs/design/system_optimization_recommendations.md) - 系统优化记录

## 🎯 测试验证

v3.0已在以下ETF上验证:
- **510300** (沪深300ETF): A级4个, WR_14 #2 ✅
- **513180** (纳指ETF): A级17个, WR_14 #8 ✅
- **510580** (科创50ETF): A级4个, WR_14 #1 ✅

## 📧 项目信息

**版本**: v3.0 (评级系统完成)
**最后更新**: 2025-09-30
**当前阶段**: 第一阶段完成，进入第二阶段（信号生成）
**项目位置**: `/Users/wenbai/Desktop/singleetfs/quant_trading`

---

🤖 Powered by Claude Code